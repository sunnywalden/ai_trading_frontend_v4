<template>
  <div class="monitoring-guideline">
    <h2 class="main-title">ğŸ“¡ APIç›‘æ§è¯´æ˜</h2>
    
    <div class="guideline-grid">
      <!-- ç›‘æ§æ¦‚è¿° -->
      <div class="guideline-card">
        <h3>ğŸ“Š ç›‘æ§æ¦‚è¿°</h3>
        <p>ç³»ç»Ÿè‡ªåŠ¨è·Ÿè¸ªæ‰€æœ‰å¤–éƒ¨APIçš„è°ƒç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ï¼š</p>
        <ul>
          <li><strong>FRED API</strong> - å®è§‚ç»æµæ•°æ®ï¼ˆè”é‚¦å‚¨å¤‡ç»æµæ•°æ®ï¼‰</li>
          <li><strong>News API</strong> - åœ°ç¼˜æ”¿æ²»æ–°é—»ä¸å¸‚åœºæƒ…ç»ª</li>
          <li><strong>Tiger API</strong> - è¡Œæƒ…æ•°æ®ï¼ˆå…è´¹å»¶è¿Ÿè¡Œæƒ…ï¼‰</li>
          <li><strong>Yahoo Finance</strong> - å¤‡ç”¨è¡Œæƒ…æ•°æ®æº</li>
          <li><strong>OpenAI API</strong> - AIå†³ç­–åŠ©æ‰‹ä¸æ–‡æœ¬åˆ†æ</li>
        </ul>
        <p>æ¯æ¬¡APIè°ƒç”¨éƒ½ä¼šè®°å½•ï¼šè°ƒç”¨æ¬¡æ•°ã€æˆåŠŸ/å¤±è´¥æ¬¡æ•°ã€å“åº”æ—¶é—´ã€é”™è¯¯è¯¦æƒ…</p>
      </div>
      
      <!-- Rate Limitç­–ç•¥è¡¨ -->
      <div class="guideline-card">
        <h3>âš™ï¸ Rate Limitç­–ç•¥ï¼ˆæˆªè‡³2026å¹´1æœˆï¼‰</h3>
        <div class="table-wrapper">
          <table class="policy-table">
            <thead>
              <tr>
                <th>API</th>
                <th>æ—¥é™åˆ¶</th>
                <th>å°æ—¶é™åˆ¶</th>
                <th>åˆ†é’Ÿé™åˆ¶</th>
                <th>å¤‡æ³¨</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FRED</strong></td>
                <td>120,000</td>
                <td>-</td>
                <td>-</td>
                <td>å»ºè®®æ§åˆ¶åœ¨åˆç†èŒƒå›´</td>
              </tr>
              <tr>
                <td><strong>News API</strong></td>
                <td>100</td>
                <td>-</td>
                <td>-</td>
                <td>å…è´¹ç‰ˆé™åˆ¶</td>
              </tr>
              <tr>
                <td><strong>Tiger</strong></td>
                <td>-</td>
                <td>3,600</td>
                <td>60</td>
                <td>çº¦1è¯·æ±‚/ç§’</td>
              </tr>
              <tr>
                <td><strong>Yahoo Finance</strong></td>
                <td>2,000</td>
                <td>100</td>
                <td>5</td>
                <td>éå®˜æ–¹APIï¼Œé¿å…è¢«é™</td>
              </tr>
              <tr>
                <td><strong>OpenAI</strong></td>
                <td>-</td>
                <td>-</td>
                <td>3</td>
                <td>å–å†³äºè®¢é˜…çº§åˆ«</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- å‘Šè­¦é˜ˆå€¼è¯´æ˜ -->
      <div class="guideline-card">
        <h3>ğŸš¨ å‘Šè­¦é˜ˆå€¼è¯´æ˜</h3>
        <div class="threshold-items">
          <div class="threshold-item normal">
            <div class="threshold-badge">ğŸŸ¢ NORMAL (æ­£å¸¸)</div>
            <p><strong>ä½¿ç”¨ç‡ &lt; 70%</strong></p>
            <p>è¿è¡Œæ­£å¸¸ï¼Œå¯ä»¥æ­£å¸¸è°ƒç”¨API</p>
          </div>
          <div class="threshold-item warning">
            <div class="threshold-badge">ğŸŸ¡ WARNING (è­¦å‘Š)</div>
            <p><strong>ä½¿ç”¨ç‡ 70% - 90%</strong></p>
            <p>è¾¾åˆ°æ—¥é…é¢çš„70%æ—¶å‘å‡ºè­¦å‘Šï¼Œå»ºè®®å‡å°‘è°ƒç”¨é¢‘ç‡ï¼Œä¼˜å…ˆä½¿ç”¨ç¼“å­˜æ•°æ®</p>
          </div>
          <div class="threshold-item critical">
            <div class="threshold-badge">ğŸ”´ CRITICAL (ä¸´ç•Œ)</div>
            <p><strong>ä½¿ç”¨ç‡ &gt; 90%</strong></p>
            <p>è¾¾åˆ°æ—¥é…é¢çš„90%æ—¶æ ‡è®°ä¸ºä¸´ç•ŒçŠ¶æ€ï¼Œç«‹å³åœæ­¢éå¿…è¦è°ƒç”¨ï¼Œç­‰å¾…é¢åº¦é‡ç½®</p>
          </div>
        </div>
      </div>
      
      <!-- ç¼“å­˜ç­–ç•¥è¯´æ˜ -->
      <div class="guideline-card">
        <h3>ğŸ’¾ ç¼“å­˜ç­–ç•¥è¯´æ˜</h3>
        <p>æ‰€æœ‰å¤–éƒ¨APIæ•°æ®éƒ½é€šè¿‡Redisç¼“å­˜ï¼Œå‡å°‘é‡å¤è°ƒç”¨ï¼š</p>
        <ul>
          <li><strong>å®è§‚æŒ‡æ ‡</strong>ï¼š6-24å°æ—¶ç¼“å­˜ï¼ˆFRED APIï¼‰</li>
          <li><strong>åœ°ç¼˜æ”¿æ²»äº‹ä»¶</strong>ï¼š4-24å°æ—¶ç¼“å­˜ï¼ˆNews APIï¼‰</li>
          <li><strong>å¸‚åœºæ•°æ®</strong>ï¼š5åˆ†é’Ÿ-1å°æ—¶ç¼“å­˜ï¼ˆTiger/Yahoo Financeï¼‰</li>
          <li><strong>AIå†³ç­–</strong>ï¼šæŒ‰éœ€è°ƒç”¨ï¼Œæ— å›ºå®šç¼“å­˜ï¼ˆOpenAIï¼‰</li>
        </ul>
        <p class="note">ğŸ’¡ è·¨è¿›ç¨‹å…±äº«ï¼šRedisç¼“å­˜åœ¨å¤šå®ä¾‹ç¯å¢ƒä¸‹å‡å°‘é‡å¤è°ƒç”¨</p>
      </div>
      
      <!-- æœ€ä½³å®è·µå»ºè®® -->
      <div class="guideline-card">
        <h3>âœ… æœ€ä½³å®è·µå»ºè®®</h3>
        <ul class="best-practices">
          <li>âœ… <strong>å®šæœŸæŸ¥çœ‹ç›‘æ§æŠ¥å‘Š</strong>ï¼šæ¯å¤©æ£€æŸ¥ä¸€æ¬¡ç›‘æ§é¡µé¢</li>
          <li>âœ… <strong>åˆç†è®¾ç½®ç¼“å­˜æ—¶é•¿</strong>ï¼šæ ¹æ®æ•°æ®æ›´æ–°é¢‘ç‡è°ƒæ•´TTL</li>
          <li>âœ… <strong>åŠæ—¶å“åº”å‘Šè­¦</strong>ï¼šæ”¶åˆ°WARNINGæ—¶è°ƒæ•´è°ƒç”¨ç­–ç•¥</li>
          <li>âœ… <strong>ä½¿ç”¨Redisç¼“å­˜</strong>ï¼šç¡®ä¿RedisæœåŠ¡æ­£å¸¸è¿è¡Œ</li>
          <li>âœ… <strong>é¿å…é¢‘ç¹å¼ºåˆ¶åˆ·æ–°</strong>ï¼šå°½é‡ä½¿ç”¨ç¼“å­˜æ•°æ®</li>
          <li>âš ï¸ <strong>æ³¨æ„éå®˜æ–¹API</strong>ï¼šYahoo Financeä¸ºéå®˜æ–¹APIï¼Œæ›´å®¹æ˜“è¢«é™</li>
          <li>âš ï¸ <strong>OpenAIæˆæœ¬æ§åˆ¶</strong>ï¼šOpenAIæŒ‰Tokenè®¡è´¹ï¼Œæ³¨æ„æ§åˆ¶è°ƒç”¨</li>
        </ul>
      </div>
      
      <!-- æ•…éšœæ’æŸ¥æŒ‡å— -->
      <div class="guideline-card">
        <h3>ğŸ”§ æ•…éšœæ’æŸ¥æŒ‡å—</h3>
        <div class="troubleshooting">
          <div class="trouble-item">
            <h4>é—®é¢˜ï¼šAPIè°ƒç”¨è¢«æ‹’ç»</h4>
            <ul>
              <li>æ£€æŸ¥Rate LimitçŠ¶æ€å¡ç‰‡</li>
              <li>æŸ¥çœ‹æ˜¯å¦æœ‰ä¸´ç•Œå‘Šè­¦</li>
              <li>ç¡®è®¤æ˜¯å¦è¾¾åˆ°é™é¢</li>
            </ul>
          </div>
          <div class="trouble-item">
            <h4>é—®é¢˜ï¼šç›‘æ§æ•°æ®ä¸æ›´æ–°</h4>
            <ul>
              <li>æ£€æŸ¥ç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€</li>
              <li>ç¡®è®¤Redisè¿æ¥æ­£å¸¸</li>
              <li>æŸ¥çœ‹æœ€åæ›´æ–°æ—¶é—´</li>
            </ul>
          </div>
          <div class="trouble-item">
            <h4>é—®é¢˜ï¼šç¼“å­˜æœªç”Ÿæ•ˆ</h4>
            <ul>
              <li>ç¡®è®¤RedisæœåŠ¡è¿è¡Œä¸­</li>
              <li>æ£€æŸ¥ç¯å¢ƒå˜é‡ <code>REDIS_ENABLED=true</code></li>
              <li>æŸ¥çœ‹åç«¯æ—¥å¿—æ˜¯å¦æœ‰"Using Redis cache"å­—æ ·</li>
            </ul>
          </div>
        </div>
      </div>
      
      <!-- é¢åº¦é‡ç½®æ—¶é—´ -->
      <div class="guideline-card">
        <h3>ğŸ• é¢åº¦é‡ç½®æ—¶é—´</h3>
        <ul>
          <li><strong>æ—¥é™é¢</strong>ï¼šUTCåˆå¤œé‡ç½®ï¼ˆåŒ—äº¬æ—¶é—´æ—©ä¸Š8ç‚¹ï¼‰</li>
          <li><strong>å°æ—¶é™é¢</strong>ï¼šæ¯å°æ—¶æ•´ç‚¹é‡ç½®</li>
          <li><strong>åˆ†é’Ÿé™é¢</strong>ï¼šæ¯åˆ†é’Ÿå¼€å§‹æ—¶é‡ç½®</li>
        </ul>
        <p class="note">âš ï¸ æ³¨æ„ï¼šé‡å¯æœåŠ¡ä¼šæ¸…ç©ºRedisè®¡æ•°å™¨ï¼ˆè®¾è®¡å¦‚æ­¤ï¼Œé¿å…ç´¯ç§¯è¿‡æœŸæ•°æ®ï¼‰</p>
      </div>
      
      <!-- é”™è¯¯ç±»å‹è¯´æ˜ -->
      <div class="guideline-card">
        <h3>âŒ å¸¸è§é”™è¯¯ç±»å‹</h3>
        <div class="error-types">
          <div class="error-type">
            <h4>Rate Limit Exceeded</h4>
            <p><strong>åŸå› </strong>ï¼šè¶…è¿‡APIé™é¢</p>
            <p><strong>å¤„ç†</strong>ï¼šç­‰å¾…é¢åº¦é‡ç½®ï¼ˆé€šå¸¸ä¸ºUTCåˆå¤œæˆ–å°æ—¶/åˆ†é’Ÿåˆ·æ–°ï¼‰</p>
          </div>
          <div class="error-type">
            <h4>Connection Timeout</h4>
            <p><strong>åŸå› </strong>ï¼šè¿æ¥è¶…æ—¶</p>
            <p><strong>å¤„ç†</strong>ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¨åé‡è¯•</p>
          </div>
          <div class="error-type">
            <h4>Authentication Failed</h4>
            <p><strong>åŸå› </strong>ï¼šè®¤è¯å¤±è´¥</p>
            <p><strong>å¤„ç†</strong>ï¼šæ£€æŸ¥APIå¯†é’¥é…ç½®</p>
          </div>
          <div class="error-type">
            <h4>Service Unavailable</h4>
            <p><strong>åŸå› </strong>ï¼šæœåŠ¡ä¸å¯ç”¨</p>
            <p><strong>å¤„ç†</strong>ï¼šå¤–éƒ¨APIæœåŠ¡æš‚æ—¶æ•…éšœï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®æº</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
// æ— éœ€é¢å¤–é€»è¾‘
</script>

<style scoped>
.monitoring-guideline {
  padding: 20px 0;
}

.main-title {
  margin: 0 0 24px;
  font-size: 1.5rem;
  font-weight: 700;
  color: #e5e7eb;
  text-align: center;
}

.guideline-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
  gap: 20px;
}

.guideline-card {
  background: linear-gradient(135deg, rgba(31, 41, 55, 0.6) 0%, rgba(15, 23, 42, 0.8) 100%);
  border: 1px solid rgba(55, 65, 81, 0.8);
  border-radius: 12px;
  padding: 24px;
}

.guideline-card h3 {
  margin: 0 0 16px;
  font-size: 1.1rem;
  font-weight: 600;
  color: #38bdf8;
}

.guideline-card h4 {
  margin: 12px 0 8px;
  font-size: 0.95rem;
  font-weight: 600;
  color: #e5e7eb;
}

.guideline-card p {
  margin: 8px 0;
  font-size: 0.9rem;
  color: #d1d5db;
  line-height: 1.6;
}

.guideline-card ul {
  margin: 8px 0;
  padding-left: 24px;
}

.guideline-card li {
  margin: 6px 0;
  font-size: 0.9rem;
  color: #d1d5db;
  line-height: 1.6;
}

.note {
  padding: 12px;
  background: rgba(56, 189, 248, 0.1);
  border-left: 3px solid #38bdf8;
  border-radius: 6px;
  font-size: 0.85rem;
  color: #38bdf8;
}

.table-wrapper {
  overflow-x: auto;
  margin: 12px 0;
}

.policy-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85rem;
}

.policy-table thead {
  background: rgba(31, 41, 55, 0.8);
}

.policy-table th,
.policy-table td {
  padding: 10px 12px;
  text-align: left;
  border: 1px solid rgba(55, 65, 81, 0.8);
}

.policy-table th {
  font-weight: 600;
  color: #9ca3af;
  font-size: 0.8rem;
  text-transform: uppercase;
}

.policy-table td {
  color: #d1d5db;
}

.threshold-items {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin: 12px 0;
}

.threshold-item {
  padding: 16px;
  border-radius: 10px;
  border: 1px solid;
}

.threshold-item.normal {
  background: rgba(34, 197, 94, 0.1);
  border-color: rgba(34, 197, 94, 0.3);
}

.threshold-item.warning {
  background: rgba(245, 158, 11, 0.1);
  border-color: rgba(245, 158, 11, 0.3);
}

.threshold-item.critical {
  background: rgba(239, 68, 68, 0.1);
  border-color: rgba(239, 68, 68, 0.3);
}

.threshold-badge {
  font-weight: 700;
  font-size: 0.9rem;
  margin-bottom: 8px;
}

.threshold-item.normal .threshold-badge {
  color: #22c55e;
}

.threshold-item.warning .threshold-badge {
  color: #f59e0b;
}

.threshold-item.critical .threshold-badge {
  color: #ef4444;
}

.threshold-item p {
  margin: 4px 0;
  font-size: 0.85rem;
}

.best-practices li {
  margin: 10px 0;
}

.troubleshooting {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.trouble-item {
  padding: 14px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
}

.trouble-item ul {
  margin: 8px 0 0;
}

.error-types {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.error-type {
  padding: 12px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
}

.error-type h4 {
  margin: 0 0 8px;
  color: #ef4444;
}

.error-type p {
  margin: 4px 0;
  font-size: 0.85rem;
}

code {
  padding: 2px 6px;
  background: rgba(0, 0, 0, 0.4);
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 0.85em;
  color: #38bdf8;
}

@media (max-width: 900px) {
  .guideline-grid {
    grid-template-columns: 1fr;
  }
}
</style>
