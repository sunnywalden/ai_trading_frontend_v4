# 个人交易系统 PRD 扩展：需求拆解与研发清单

> 基于 `docs/PRD_PERSONAL_TRADING.md` 的实施版拆解
> 文档版本：v1.0
> 日期：2026-01-16

---

## 1. 需求拆解（按模块）

### 1.1 交易仪表盘

用户故事：

- 作为个人交易者，我希望一屏看到账户盈亏与风险水位，便于快速决策。

功能点：

- 显示账户权益、今日盈亏、风险水位（Delta/Gamma/Theta）
- 显示当前交易计划执行状态（完成率、待执行）
- 支持一键刷新

验收标准：

- 页面加载 ≤ 2s
- 风险水位与后端一致误差 ≤ 1%
- 刷新按钮可用性 ≥ 99%

优先级：

- P0

---

### 1.2 交易计划卡片

用户故事：

- 作为交易者，我希望在执行前看到清晰计划与风控信息，避免冲动交易。

功能点：

- 计划字段：入场/止损/止盈/仓位/计划有效期
- 状态：未触发 / 已执行 / 偏离
- 触发价位提醒（通知 + UI 标记）

验收标准：

- 计划偏离标记准确率 ≥ 95%
- 触发提醒延迟 ≤ 3s

优先级：

- P0

---

### 1.3 行为评分（简化）

用户故事：

- 我希望系统提示我是否过度交易或偏离计划，帮助保持纪律。

功能点：

- 保留指标：过度交易、追涨杀跌、报复性交易
- 输出评分 + 一句话建议

验收标准：

- 评分刷新频率 ≤ 1 分钟
- 建议文本可读性（用户评分 ≥ 4/5）

优先级：

- P1

---

### 1.4 持仓评估（增强）

用户故事：

- 我希望看到当前持仓是否超出风险预算，并获得简明建议。

功能点：

- 增加：风险预算占用率、计划偏离度
- 超额提示（颜色 + 提示语）

验收标准：

- 风险预算占用率与后端一致
- 超额提示在阈值达到时显示

优先级：

- P0

---

### 1.5 执行列表（机会页改造）

用户故事：

- 我希望机会列表只展示符合计划的标的，避免分心。

功能点：

- 机会列表与计划匹配标签
- 可快速加入计划或忽略

验收标准：

- 计划匹配准确率 ≥ 90%

优先级：

- P1

---

### 1.6 宏观风险（降级）

用户故事：

- 我只需要宏观风险简报，避免信息过载。

功能点：

- 仅保留摘要 + 风险等级
- 详情折叠

验收标准：

- 默认页面内容不超过 1 屏

优先级：

- P2

---

### 1.7 系统健康（替代 API 监控）

用户故事：

- 我只关心系统是否可用，不需要复杂监控数据。

功能点：

- 显示服务状态、最近更新时间
- 失败提示与重试按钮

验收标准：

- 状态刷新成功率 ≥ 99%

优先级：

- P2

---

## 2. 前后端改造清单

### 2.1 前端页面与组件调整

- `BehaviorScorePage.vue`：缩减指标、突出交易偏离
- `PositionsPage.vue`：新增预算占用率与计划偏离度字段
- `OpportunitiesPage.vue`：重命名为执行列表（UI + 文案）
- `MacroRiskPage.vue`：收敛内容为摘要
- `ApiMonitoringPage.vue`：替换为系统健康页（可复用 `fetchMonitoringHealth`）

### 2.2 API 字段扩展（后端）

- `positions/assessment`：增加 `budget_utilization`, `plan_deviation` 字段
- 行为评分接口：增加 `plan_deviation_score` 或 `discipline_score`
- 计划接口（新增）：
  - `GET /v1/plan/list`
  - `POST /v1/plan/create`
  - `PATCH /v1/plan/{id}`

### 2.3 兼容策略

- 新字段缺失时前端降级为 `N/A`
- 未上线计划接口时，隐藏计划卡片入口

---

## 3. 研发任务拆解（按版本）

### V1（P0）

- 仪表盘指标聚合
- 计划卡片基础展示
- 持仓评估字段扩展
- 行为评分简化

### V2（P1）

- 触发提醒模块
- 复盘日志与评分
- 计划执行率统计

### V3（P1）

- 风险预算模块
- 连续亏损提醒
- 资金曲线可视化

### V4（P2）

- AI 复盘总结
- 胜率分布解释

### V5（P2）

- 半自动执行（止损/止盈）
- 策略组合模式

---

## 4. 风险与依赖

- 行情数据稳定性（影响风险水位与提醒）
- 计划与复盘字段缺失导致功能不可用
- 自动提醒需与券商 API 安全隔离

---

## 5. 交付与验收

- 每个版本完成后输出「可用性 Checklist」
- 关键指标达到验收标准后进入下一版

---

## 6. 附录：当前功能调整映射摘要

- 保留并强化：行为评分、持仓评估、风险水位
- 降级展示：宏观风险
- 改名与定位调整：潜在机会 → 执行列表
- 移除：API 监控（用系统健康替代）
