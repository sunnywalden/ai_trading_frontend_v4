# V3.2 版本需求文档 - 响应式设计和移动端适配

## 一、版本概述

### 1.1 版本目标
完成系统的全面响应式设计改造，确保在不同终端（桌面端、平板端、移动端）上都能提供良好的用户体验。

### 1.2 问题背景
当前版本存在以下移动端体验问题：
1. 手机端访问量化闭环页面时，页面无法横向滚动
2. CycleControlPanel（周期控制面板）的复选框在小屏设备上无法正常勾选
3. 表格内容在移动端显示不全，无法查看完整信息
4. 按钮和交互元素在触摸屏上操作困难
5. 整体布局在不同分辨率下缺乏弹性适配

### 1.3 目标设备规格

| 设备类型 | 屏幕宽度 | 目标分辨率示例 | 交互方式 |
|---------|---------|--------------|---------|
| 桌面端 | ≥1400px | 1920×1080, 2560×1440 | 鼠标+键盘 |
| 笔记本 | 1024-1399px | 1366×768, 1440×900 | 鼠标+键盘 |
| 平板 | 768-1023px | iPad (1024×768) | 触摸 |
| 手机（横屏）| 568-767px | iPhone 横屏 (667×375) | 触摸 |
| 手机（竖屏）| <568px | iPhone (375×667) | 触摸 |

## 二、核心需求

### 2.1 响应式布局需求

#### 2.1.1 QuantLoopDashboard（量化闭环仪表盘）
**当前问题**：
- 在手机端，grid布局的两列显示导致内容被压缩
- 信号表格（PendingSignalsTable）在小屏上无法正常查看所有列
- CycleControlPanel在小屏上显示异常

**需求**：
- **≥1200px**: 保持当前两列布局
- **768-1199px**: 单列布局，组件自动堆叠
- **<768px**: 
  - 单列布局
  - 卡片式信息展示
  - 可横向滑动的表格区域
  - 精简显示，隐藏次要信息

#### 2.1.2 CycleControlPanel（周期控制面板）
**当前问题**：
- 复选框和文字在移动端点击区域过小
- 按钮布局在窄屏上显示不合理
- "运行结果"区域的phases-grid在小屏上显示混乱

**需求**：
- **≥768px**: 保持当前横向布局
- **<768px**:
  - 复选框和标签增大触摸面积（最小44×44px）
  - 按钮改为纵向堆叠，宽度100%
  - phases-grid改为单列显示
  - 折叠非关键信息，只显示摘要

#### 2.1.3 PendingSignalsTable（待执行信号表格）
**当前问题**：
- 表格列数过多，在移动端无法显示完整
- 操作按钮在移动端不易点击

**需求**：
- **≥1024px**: 显示所有列
- **768-1023px**: 隐藏部分非关键列（如strategy_id、score等）
- **<768px**:
  - 卡片式展示，每个信号一张卡片
  - 横向滑动查看更多操作
  - 批量操作改为底部固定工具栏

#### 2.1.4 页面导航和整体布局
**需求**：
- 所有视图支持安全区域（safe area）适配（考虑刘海屏、底部手势条）
- 页面padding在不同设备上动态调整
- 横向滚动区域添加明显的视觉提示
- 底部固定的操作栏在移动端保持可用性

### 2.2 触摸交互需求

#### 2.2.1 触摸目标尺寸
根据 Apple HIG 和 Material Design 指南：
- **最小点击区域**: 44×44px (iOS) / 48×48dp (Android)
- **推荐点击区域**: 48×48px 以上
- **间距**: 相邻可点击元素间距至少 8px

#### 2.2.2 手势支持
- 横向滑动查看表格
- 长按显示详细信息
- 下拉刷新（考虑实现）
- 双指缩放（对图表组件）

#### 2.2.3 触摸反馈
- 所有可点击元素提供视觉反馈（:active状态）
- 按钮按下时提供触觉反馈（通过CSS transition）
- 长操作显示loading状态

### 2.3 性能需求

#### 2.3.1 加载性能
- 首屏加载时间 <2s
- 交互响应时间 <100ms
- 图片懒加载
- 按需加载大型组件

#### 2.3.2 滚动性能
- 使用 transform 和 opacity 进行动画
- 避免 layout thrashing
- 使用 will-change 优化性能

### 2.4 可访问性需求
- 所有交互元素支持键盘导航
- 提供ARIA标签
- 支持屏幕阅读器
- 颜色对比度符合WCAG 2.1 AA标准

### 2.5 浏览器兼容性
- iOS Safari 14+
- Android Chrome 90+
- Desktop Chrome/Firefox/Safari 最新版
- 优雅降级策略（不支持的功能提供fallback）

## 三、非功能需求

### 3.1 用户体验
- 所有页面在不同设备上加载流畅
- 交互元素大小适合触摸操作
- 信息层级清晰，重要信息优先展示
- 横屏和竖屏模式都能正常使用

### 3.2 可维护性
- 建立统一的响应式设计系统
- 创建可复用的断点变量
- 提供完整的设计指南文档
- 代码注释清晰，便于后续扩展

### 3.3 测试要求
- 在主流设备上进行真机测试
- 使用开发者工具模拟不同设备
- 记录测试用例和结果
- 建立回归测试检查清单

## 四、技术约束

### 4.1 框架和工具
- Vue 3 + TypeScript
- Vite 构建工具
- CSS Modules / Scoped CSS
- 不引入额外的UI框架（保持轻量）

### 4.2 CSS方案
- 使用CSS Grid和Flexbox
- 媒体查询断点统一管理
- 使用CSS变量（自定义属性）
- 避免使用固定宽度/高度

### 4.3 兼容性方案
- Vite自动处理CSS前缀
- 使用现代CSS特性的同时提供fallback
- 特性检测（@supports）

## 五、实施优先级

### P0 - 高优先级（必须完成）
1. CycleControlPanel移动端复选框问题修复
2. 页面整体响应式布局改造
3. 触摸区域尺寸优化

### P1 - 中优先级（应该完成）
1. 表格卡片式展示
2. 横向滚动体验优化
3. 性能优化

### P2 - 低优先级（可以延后）
1. 手势支持（长按、双指缩放）
2. 下拉刷新
3. 高级动画效果

## 六、验收标准

### 6.1 功能验收
- [ ] 在iPhone SE (375×667) 上能够勾选"执行真实交易"
- [ ] 在iPad (1024×768) 上所有功能正常
- [ ] 在1080p桌面显示器上布局美观
- [ ] 横屏和竖屏切换无异常

### 6.2 性能验收
- [ ] Lighthouse移动端评分 ≥80分
- [ ] 首屏加载时间 <2s
- [ ] 交互响应时间 <100ms
- [ ] 无明显的滚动卡顿

### 6.3 兼容性验收
- [ ] iOS Safari测试通过
- [ ] Android Chrome测试通过
- [ ] 桌面主流浏览器测试通过

### 6.4 用户体验验收
- [ ] 所有按钮和链接易于点击
- [ ] 信息清晰可读，无需缩放
- [ ] 无水平滚动条（除明确设计的区域）
- [ ] 表单输入体验良好

## 七、风险评估

### 7.1 技术风险
- **风险**: CSS Grid在老旧设备上的兼容性
- **缓解**: 使用@supports检测，提供flexbox fallback

### 7.2 测试风险
- **风险**: 缺少真实设备测试
- **缓解**: 使用BrowserStack或类似服务进行云端测试

### 7.3 时间风险
- **风险**: 响应式改造涉及组件较多，可能超期
- **缓解**: 按优先级分阶段实施，P0功能优先保证

## 八、后续优化方向

### 8.1 渐进式增强
- PWA支持（离线访问）
- 添加到主屏幕功能
- 推送通知

### 8.2 高级交互
- 图表的触摸手势操作
- 拖拽排序
- 自定义仪表盘布局

### 8.3 国际化
- RTL布局支持
- 多语言界面

---

**文档版本**: v1.0  
**创建日期**: 2026-02-14  
**负责人**: Development Team  
**评审状态**: Pending Review
